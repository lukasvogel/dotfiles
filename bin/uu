#!/bin/bash
UNAMESTR=`uname`
if [[ "$UNAMESTR" == 'Linux' ]]; then
    sudo apt-get update && \
        sudo apt-get upgrade && \
        sudo apt-get dist-upgrade && \
        sudo apt-get autoremove && \
        sudo apt-get clean
elif [[ "$UNAMESTR" == 'Darwin' ]]; then
    echo "Fetching updates..."
    brew update && \
        brew upgrade --all && \
        brew cleanup
    #conda update --all
else
    echo "Platform not supported"
    exit 1
fi

# Spacemacs
#git pull --rebase && \
cd ~/.emacs.d && \
git pull && \
git submodule sync; git submodule update

# pip packages
pip freeze --local | grep -v '^\-e' | cut -d = -f 1  | xargs sudo pip install -U

# neovim
if [[ "$UNAMESTR" == 'Darwin' ]]; then
    read -p "Do you want to force a neovim upgrade? [y/N] " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        brew reinstall --HEAD neovim
    fi

    read -p "Do you want to update KWM? [y/N] " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        cd ~/code/kwm && git pull && make ; cd -
    fi

fi
